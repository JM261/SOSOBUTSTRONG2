<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper 
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="memberMapper">

	<resultMap type="member" id="memberResultset">
		<result column="USER_NO" property="userNo"/>
		<result column="USER_TYPE" property="userType"/>
		<result column="USER_ID" property="userId"/>
		<result column="PASSWORD" property="userPwd"/>
		<result column="USER_NAME" property="userName"/>
		<result column="EMAIL" property="email"/>
		<result column="PHONE" property="phone"/>
		<result column="ADDRESS" property="address"/>
		<result column="GENDER" property="gender"/>
		<result column="BIRTH" property="birth"/>
		<result column="POINT" property="point"/>
		<result column="STATUS" property="status"/>
	</resultMap>
	
	<resultMap type="seller" id="sellerResultset">
		<result column="SELLER_NAME" property="sellerName"/>
		<result column="SELLER_BRN" property="sellerBRN"/>
		<result column="SELLER_PHONE" property="sellerPhone"/>
		<result column="SELLER_LOCATION" property="sellerLocation"/>
		<result column="SELLER_INTRO" property="sellerIntro"/>
		<result column="SELLER_IMAGE" property="sellerImage"/>
		<result column="SELLER_IMAGEPATH" property="sellerImagePath"/>
		<result column="STATUS" property="sellerStatus"/>
	</resultMap>
	
	<!-- 로그인 -->
	<select id="loginMember" resultMap="memberResultset" parameterType="member">
		SELECT USER_NO, USER_TYPE, USER_ID, PASSWORD, USER_NAME, EMAIL, PHONE, ADDRESS, GENDER, BIRTH, POINT, STATUS
		FROM MEMBER
		WHERE USER_ID = #{userId}
		AND STATUS = 'Y'
	</select>
	
	<!-- 일반회원 가입용 쿼리문 -->
	<insert id="insertMember" parameterType="member">
		INSERT INTO 
			 MEMBER
				   (USER_NO, USER_TYPE, USER_ID, PASSWORD, USER_NAME, EMAIL, PHONE, ADDRESS, GENDER, BIRTH)
			 VALUES
			 	   (SEQ_MNO.nextval, 1, #{userId}, #{userPwd}, #{userName}, #{email}, #{phone}, #{address}, #{gender}, #{birth})
	</insert>
	<!-- 아이디 중복체크 -->
	<select id="idCheck" resultType="_int">
		 SELECT COUNT(*)
		 FROM MEMBER
		 WHERE USER_ID = #{checkId}
	</select>
	
	

	<!-- 상호 중복체크 -->
	<select id="checkName" resultType="_int">
		 SELECT COUNT(*)
		 FROM SELLER
		 WHERE SELLER_NAME = #{checkName}
	</select>
	
	<!-- 판매자 회원가입  -->
	<insert id="insertSeller1" parameterType="member">
		INSERT INTO 
			 MEMBER
				   (USER_NO, USER_TYPE, USER_ID, PASSWORD, USER_NAME, EMAIL, PHONE, ADDRESS, GENDER, BIRTH)
			 VALUES
			 	   (SEQ_MNO.nextval, 2, #{userId}, #{userPwd}, #{userName}, #{email}, #{phone}, #{address}, #{gender}, #{birth})
	</insert>
	
	<!-- 판매자 회원가입2  -->
	<insert id="insertSeller2" parameterType="seller">
		INSERT INTO 
			 SELLER
				   (USER_NO, SELLER_NAME, SELLER_BRN, SELLER_PHONE, SELLER_LOCATION, SELLER_INTRO, SELLER_IMAGE , SELLER_IMAGEPATH)
			 VALUES
			 	   (SEQ_MNO.currval, #{sellerName}, #{sellerBRN}, #{sellerPhone}, #{sellerLocation}, #{sellerIntro}, #{sellerImage}, #{sellerImagePath})
	</insert>
	
	<!-- 일반회원 정보 수정 -->
	<update id="updateMember" parameterType="member">
		UPDATE MEMBER
		   SET 
		       USER_NAME =  #{userName},
		       EMAIL = #{email},
		       PHONE = #{phone},
		       ADDRESS = #{address},
		       GENDER = #{gender},
		       BIRTH = #{birth}
		 WHERE USER_ID = #{userId}    
	</update>
	
	<!-- 일반회원 탈퇴 -->
	<update id="deleteMember" parameterType="string">
		 UPDATE MEMBER
		 	SET STATUS = 'N'
		  WHERE USER_ID = #{userId}
	</update>
	
</mapper>
